
/**
  1、发送消息之前，判断手机是否连接网络  网络是否可以ping通
  2、发消息之前，判断设备是否在线



 设置参数命令
 发送消息时 增加时间判断 2s之内未收到消息不能发送 若接收到消息则移除，否则继续发送
 接收到消息或者发送失败移除，发送


 循环注册手机 然后去判断绑定设备 假如网络ping通的话

 循环去订阅消息
 (0.5)

 图表   数据未改动 (1)
 Group schedule 未修改完成 (1)


相关变量
时、分、周、重复、是在执行
1、周相同 判断时间
 */

----------  v0.5.0

----------  v0.5.1
修改  添加设备时 存在隐藏设备中的未移除
收到重置命令，2s钟之内不收消息
 去掉确认的提示框

在添加Schedule 或者Schedule列表界面 程序会崩溃(两个界面 Timeout问题 )
选择周的话 颜色改为绿色



---------------    20150203   -------------
1、组中添加设备后 没有收到组中设备的信息组不上线（刷新组、或者控制、请求组中的某个设备的状态）
2、组中的某个设备离线之后，组不显示离线

如果在timer时间之内断电打开 就继续执行

6:00（ON） - 10:00 (OFF)  在 7:30 时 OFF  在8:00 ON  （10:00 不执行）

Timer 界面需要刷新

Timer 两个按钮 根据返回的数据显示不同的状态，

年后(修改要点)--- 消息接收改为广播 可以通知每个界面
   A、组的状态与设备的状态不符的问题
       1、组中的一个设备掉线，组就掉线
       2、组中的一个设备off，组就off
       3、组中的设备全部on，组on

   B、组的Schedule添加时,有些设备Schedule没添加成功（1、发送消息时组中未检测到这个设备 2、发送消息没有发送成功 3、发送消息时设备掉线）
       1、发送消息时组中未检测到这个设备，或者没有给这个设备发送消息
       2、发送消息，没有发送成功
       3、发送消息时，设备掉线 没有发送成功
   组添加的Schedule,在单个设备中可能处于执行过的状态（时间小于当前时间）

   C、请求Privacy时，设备太多的话，请求时间过长
       1、分多个线程来执行

   D、Device 设置界面重置选项去掉
       1、智能通过硬件收到重置

   E、图表数据返回的timestamp 要转成UTF时间 请求时也是UTF时间 (图表这里单例模式 数据不变需要修改  目前只展示了电量、消费没有计算和显示图表)
       1、时间timestamp 转成UTF时间

   F、app 不稳定，挂掉，可能就是因为消息接收时的处理机制问题
       目前通知到一个Activity ，在通过这个Activity Listener 转发


问题 20160219
    1、Android兼容性问题（谈总手机安装之后打开崩溃）
    2、图表返回数据 timestamp 转成UTF时间 （图表界面美化）---> 计算 Today Total
    3、组的状态与组中的设备状态（需要多个设备）
    4、每次返回设备列表界面刷新一次，并且在此界面才定时刷新  否则不定时刷新（修改）
    5、通知界面UI修改 修改为输入框

    1、本地不在线订阅远程消息，本地在线取消远程消息
    2、远程连接问题，有设备连接MQTT Server,无设备不连接MQTT Server


修改说明
    1、schedule 其他手机改变之后 在本地模式下不会返回，远程模式下会转发（如果两个需要更新 必须远程模式连接成功）

